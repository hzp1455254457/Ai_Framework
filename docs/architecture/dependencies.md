# æ¨¡å—ä¾èµ–å…³ç³»å›¾

## ğŸ“‹ æ–‡æ¡£è¯´æ˜

æœ¬æ–‡æ¡£è®°å½•AIæ¡†æ¶é¡¹ç›®çš„æ¨¡å—ä¾èµ–å…³ç³»ï¼Œå¸®åŠ©ç†è§£æ¨¡å—é—´çš„ä¾èµ–æ–¹å‘å’ŒèŒè´£è¾¹ç•Œã€‚

**æ›´æ–°è§„åˆ™**ï¼š
- æ–°å¢æ¨¡å—æ—¶å¿…é¡»æ›´æ–°ä¾èµ–å…³ç³»å›¾
- æ¨¡å—é—´ä¾èµ–å…³ç³»å˜æ›´æ—¶å¿…é¡»æ›´æ–°æœ¬æ–‡æ¡£
- å‘ç°å¾ªç¯ä¾èµ–æ—¶å¿…é¡»ç«‹å³ä¿®å¤

---

## ğŸ—ï¸ æ•´ä½“ä¾èµ–å…³ç³»

### ä¾èµ–å±‚æ¬¡å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          åº”ç”¨å±‚ (Application Layer)          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ Web UI â”‚  â”‚  CLI   â”‚  â”‚  API   â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚          â”‚           â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       æ ¸å¿ƒæœåŠ¡å±‚ (Core Service Layer)        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚  LLM   â”‚  â”‚ Vision â”‚  â”‚ Agent  â”‚        â”‚
â”‚  â”‚Service â”‚  â”‚Service â”‚  â”‚ Engine â”‚        â”‚
â”‚  â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚          â”‚           â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         é€‚é…å™¨å±‚ (Adapter Layer)             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚OpenAI  â”‚  â”‚Claude  â”‚  â”‚ Local  â”‚        â”‚
â”‚  â”‚Adapter â”‚  â”‚Adapter â”‚  â”‚Adapter â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     åŸºç¡€è®¾æ–½å±‚ (Infrastructure Layer)        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ Config â”‚  â”‚ Cache  â”‚  â”‚ Storageâ”‚        â”‚
â”‚  â”‚Manager â”‚  â”‚Manager â”‚  â”‚Manager â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“¦ æ¨¡å—ä¾èµ–è¯¦ç»†è¯´æ˜

### åº”ç”¨å±‚ä¾èµ–

#### `api/` æ¨¡å—
**ä¾èµ–**ï¼š
- âœ… `core/llm/` - LLMæœåŠ¡
- âœ… `core/vision/` - è§†è§‰æœåŠ¡
- âœ… `core/audio/` - éŸ³é¢‘æœåŠ¡
- âœ… `core/agent/` - Agentå¼•æ“
- âœ… `infrastructure/config/` - é…ç½®ç®¡ç†
- âœ… `infrastructure/log/` - æ—¥å¿—ç®¡ç†

**ä¸ä¾èµ–**ï¼š
- âŒ `cli/` - CLIæ¨¡å—
- âŒ `web/` - Web UIæ¨¡å—

#### `cli/` æ¨¡å—
**ä¾èµ–**ï¼š
- âœ… `core/llm/` - LLMæœåŠ¡
- âœ… `core/vision/` - è§†è§‰æœåŠ¡
- âœ… `core/audio/` - éŸ³é¢‘æœåŠ¡
- âœ… `core/agent/` - Agentå¼•æ“
- âœ… `infrastructure/config/` - é…ç½®ç®¡ç†

**ä¸ä¾èµ–**ï¼š
- âŒ `api/` - APIæ¨¡å—
- âŒ `web/` - Web UIæ¨¡å—

#### `web/` æ¨¡å—
**ä¾èµ–**ï¼š
- âœ… `api/` - APIæ¥å£ï¼ˆå¯é€‰ï¼Œå¯ç›´æ¥è°ƒç”¨coreï¼‰
- âœ… `core/*` - æ ¸å¿ƒæœåŠ¡ï¼ˆå¯ç›´æ¥è°ƒç”¨ï¼‰
- âœ… `infrastructure/config/` - é…ç½®ç®¡ç†

**ä¸ä¾èµ–**ï¼š
- âŒ `cli/` - CLIæ¨¡å—

---

### æ ¸å¿ƒæœåŠ¡å±‚ä¾èµ–

#### `core/llm/` æ¨¡å—
**ä¾èµ–**ï¼š
- âœ… `core/base/` - åŸºç¡€ç±»å’Œæ¥å£
- âœ… `infrastructure/config/` - é…ç½®ç®¡ç†
- âœ… `infrastructure/cache/` - ç¼“å­˜ç®¡ç†
- âœ… `infrastructure/log/` - æ—¥å¿—ç®¡ç†

**è¢«ä¾èµ–**ï¼š
- âœ… `api/routes/llm.py` - APIè·¯ç”±
- âœ… `cli/commands/chat.py` - CLIå‘½ä»¤
- âœ… `core/agent/` - Agentå¼•æ“

#### `core/vision/` æ¨¡å—
**ä¾èµ–**ï¼š
- âœ… `core/base/` - åŸºç¡€ç±»å’Œæ¥å£
- âœ… `infrastructure/config/` - é…ç½®ç®¡ç†
- âœ… `infrastructure/log/` - æ—¥å¿—ç®¡ç†

**è¢«ä¾èµ–**ï¼š
- âœ… `api/routes/vision.py` - APIè·¯ç”±
- âœ… `core/agent/` - Agentå¼•æ“ï¼ˆå¯ä½¿ç”¨è§†è§‰å·¥å…·ï¼‰

#### `core/audio/` æ¨¡å—
**ä¾èµ–**ï¼š
- âœ… `core/base/` - åŸºç¡€ç±»å’Œæ¥å£
- âœ… `infrastructure/config/` - é…ç½®ç®¡ç†
- âœ… `infrastructure/log/` - æ—¥å¿—ç®¡ç†

**è¢«ä¾èµ–**ï¼š
- âœ… `api/routes/audio.py` - APIè·¯ç”±
- âœ… `core/agent/` - Agentå¼•æ“ï¼ˆå¯ä½¿ç”¨éŸ³é¢‘å·¥å…·ï¼‰

#### `core/agent/` æ¨¡å—
**ä¾èµ–**ï¼š
- âœ… `core/base/` - åŸºç¡€ç±»å’Œæ¥å£
- âœ… `core/llm/` - LLMæœåŠ¡ï¼ˆç”¨äºAgentæ¨ç†ï¼‰
- âœ… `core/vision/` - è§†è§‰æœåŠ¡ï¼ˆå¯é€‰å·¥å…·ï¼‰
- âœ… `core/audio/` - éŸ³é¢‘æœåŠ¡ï¼ˆå¯é€‰å·¥å…·ï¼‰
- âœ… `infrastructure/config/` - é…ç½®ç®¡ç†
- âœ… `infrastructure/storage/` - å­˜å‚¨ç®¡ç†ï¼ˆè®°å¿†å­˜å‚¨ï¼‰
- âœ… `infrastructure/log/` - æ—¥å¿—ç®¡ç†

**è¢«ä¾èµ–**ï¼š
- âœ… `api/routes/agent.py` - APIè·¯ç”±
- âœ… `cli/commands/agent.py` - CLIå‘½ä»¤

---

### åŸºç¡€è®¾æ–½å±‚ä¾èµ–

#### `infrastructure/config/` æ¨¡å—
**ä¾èµ–**ï¼š
- âŒ ä¸ä¾èµ–å…¶ä»–ä¸šåŠ¡æ¨¡å—ï¼ˆæœ€åº•å±‚ï¼‰

**è¢«ä¾èµ–**ï¼š
- âœ… æ‰€æœ‰å…¶ä»–æ¨¡å—

#### `infrastructure/cache/` æ¨¡å—
**ä¾èµ–**ï¼š
- âœ… `infrastructure/config/` - é…ç½®ç®¡ç†ï¼ˆå¯é€‰ï¼‰

**è¢«ä¾èµ–**ï¼š
- âœ… `core/llm/` - LLMæœåŠ¡
- âœ… `core/agent/` - Agentå¼•æ“

#### `infrastructure/log/` æ¨¡å—
**ä¾èµ–**ï¼š
- âœ… `infrastructure/config/` - é…ç½®ç®¡ç†ï¼ˆå¯é€‰ï¼‰

**è¢«ä¾èµ–**ï¼š
- âœ… æ‰€æœ‰éœ€è¦æ—¥å¿—çš„æ¨¡å—

#### `infrastructure/storage/` æ¨¡å—
**ä¾èµ–**ï¼š
- âœ… `infrastructure/config/` - é…ç½®ç®¡ç†

**è¢«ä¾èµ–**ï¼š
- âœ… `core/agent/` - Agentå¼•æ“ï¼ˆè®°å¿†å­˜å‚¨ï¼‰
- âœ… `core/llm/` - LLMæœåŠ¡ï¼ˆå¯¹è¯å†å²å­˜å‚¨ï¼‰

---

## ğŸš« ç¦æ­¢çš„ä¾èµ–å…³ç³»

### ä¸¥æ ¼ç¦æ­¢çš„ä¾èµ–

1. **æ ¸å¿ƒæ¨¡å—ä¸èƒ½ä¾èµ–åº”ç”¨å±‚**
   ```
   âŒ core/llm/ â†’ api/
   âŒ core/llm/ â†’ cli/
   âŒ core/llm/ â†’ web/
   ```

2. **åŸºç¡€è®¾æ–½ä¸èƒ½ä¾èµ–ä¸šåŠ¡æ¨¡å—**
   ```
   âŒ infrastructure/config/ â†’ core/
   âŒ infrastructure/cache/ â†’ core/
   âŒ infrastructure/log/ â†’ core/
   ```

3. **å¾ªç¯ä¾èµ–**
   ```
   âŒ module_a â†’ module_b â†’ module_a
   ```

---

## ğŸ“Š ä¾èµ–å…³ç³»çŸ©é˜µ

| æ¨¡å— | core/base | core/llm | core/vision | core/agent | infra/config | infra/cache | infra/log | infra/storage |
|------|-----------|----------|-------------|------------|--------------|-------------|-----------|---------------|
| **api/** | âœ… | âœ… | âœ… | âœ… | âœ… | âŒ | âœ… | âŒ |
| **cli/** | âœ… | âœ… | âœ… | âœ… | âœ… | âŒ | âœ… | âŒ |
| **web/** | âœ… | âœ… | âœ… | âœ… | âœ… | âŒ | âœ… | âŒ |
| **core/llm/** | âœ… | âŒ | âŒ | âŒ | âœ… | âœ… | âœ… | âœ… |
| **core/vision/** | âœ… | âŒ | âŒ | âŒ | âœ… | âŒ | âœ… | âŒ |
| **core/audio/** | âœ… | âŒ | âŒ | âŒ | âœ… | âŒ | âœ… | âŒ |
| **core/agent/** | âœ… | âœ… | âœ… | âœ… | âœ… | âŒ | âœ… | âœ… |
| **infra/config/** | âŒ | âŒ | âŒ | âŒ | âŒ | âŒ | âŒ | âŒ |
| **infra/cache/** | âŒ | âŒ | âŒ | âŒ | âœ… | âŒ | âŒ | âŒ |
| **infra/log/** | âŒ | âŒ | âŒ | âŒ | âœ… | âŒ | âŒ | âŒ |
| **infra/storage/** | âŒ | âŒ | âŒ | âŒ | âœ… | âŒ | âŒ | âŒ |

**å›¾ä¾‹**ï¼š
- âœ… å…è®¸ä¾èµ–
- âŒ ç¦æ­¢ä¾èµ–

---

## ğŸ” å¾ªç¯ä¾èµ–æ£€æµ‹

### æ£€æµ‹æ–¹æ³•

ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•æ£€æµ‹å¾ªç¯ä¾èµ–ï¼š

1. **é™æ€åˆ†æ**ï¼šæ£€æŸ¥importè¯­å¥
2. **è¿è¡Œæ—¶æ£€æµ‹**ï¼šä½¿ç”¨å·¥å…·æ£€æµ‹å¯¼å…¥å¾ªç¯
3. **ä»£ç å®¡æŸ¥**ï¼šå®¡æŸ¥ä»£ç æ—¶æ£€æŸ¥ä¾èµ–å…³ç³»

### å¸¸è§å¾ªç¯ä¾èµ–åœºæ™¯

#### åœºæ™¯1ï¼šæ¨¡å—A â†’ æ¨¡å—B â†’ æ¨¡å—A
**è§£å†³æ–¹æ¡ˆ**ï¼š
- æå–å…¬å…±æ¥å£åˆ°baseæ¨¡å—
- ä½¿ç”¨ä¾èµ–æ³¨å…¥è§£è€¦

#### åœºæ™¯2ï¼šé—´æ¥å¾ªç¯ä¾èµ–
**ç¤ºä¾‹**ï¼š`A â†’ B â†’ C â†’ A`
**è§£å†³æ–¹æ¡ˆ**ï¼š
- é‡æ„ä¾èµ–å…³ç³»ï¼Œæ‰“ç ´å¾ªç¯
- æå–å…¬å…±åŠŸèƒ½åˆ°ç‹¬ç«‹æ¨¡å—

---

## ğŸ”„ ä¾èµ–å…³ç³»å˜æ›´è§„åˆ™

### æ–°å¢ä¾èµ–è§„åˆ™

1. **æ£€æŸ¥ä¾èµ–æ–¹å‘**
   - æ˜¯å¦è¿åä¾èµ–å±‚æ¬¡è§„åˆ™ï¼Ÿ
   - æ˜¯å¦ä¼šäº§ç”Ÿå¾ªç¯ä¾èµ–ï¼Ÿ

2. **è¯„ä¼°ä¾èµ–å¿…è¦æ€§**
   - æ˜¯å¦å¯ä»¥é€šè¿‡æ¥å£è§£è€¦ï¼Ÿ
   - æ˜¯å¦å¯ä»¥ä½¿ç”¨ä¾èµ–æ³¨å…¥ï¼Ÿ

3. **æ›´æ–°æ–‡æ¡£**
   - æ›´æ–°æœ¬æ–‡æ¡£çš„ä¾èµ–å…³ç³»å›¾
   - æ›´æ–°ä¾èµ–å…³ç³»çŸ©é˜µ
   - è®°å½•å˜æ›´åŸå› 

### ç§»é™¤ä¾èµ–è§„åˆ™

1. **æ£€æŸ¥å½±å“èŒƒå›´**
   - å“ªäº›æ¨¡å—ä¼šå—å½±å“ï¼Ÿ
   - æ˜¯å¦éœ€è¦é‡æ„ï¼Ÿ

2. **æ›´æ–°æ–‡æ¡£**
   - æ›´æ–°æœ¬æ–‡æ¡£
   - æ›´æ–°ç›¸å…³è®¾è®¡æ–‡æ¡£

---

## ğŸ› ï¸ ä¾èµ–å…³ç³»ç®¡ç†å·¥å…·

### æ¨èå·¥å…·

1. **pipdeptree**ï¼šæŸ¥çœ‹Pythonä¾èµ–æ ‘
   ```bash
   pip install pipdeptree
   pipdeptree
   ```

2. **pydeps**ï¼šå¯è§†åŒ–Pythonä¾èµ–å…³ç³»
   ```bash
   pip install pydeps
   pydeps core/
   ```

3. **import-linter**ï¼šæ£€æŸ¥å¯¼å…¥è§„åˆ™
   ```bash
   pip install import-linter
   lint-imports
   ```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [æ¶æ„æ–¹æ¡ˆæ–‡æ¡£](../../AIæ¡†æ¶æ¶æ„æ–¹æ¡ˆæ–‡æ¡£.md)
- [é¡¹ç›®è§„åˆ™](../.cursor/rules/ProjectRules.mdc)
- [ä»£ç è§„èŒƒ](../.cursor/rules/CodeStandards.mdc)

---

## ğŸ”„ æ–‡æ¡£æ›´æ–°è®°å½•

| æ—¥æœŸ | ç‰ˆæœ¬ | æ›´æ–°å†…å®¹ | æ›´æ–°äºº |
|------|------|---------|--------|
| 2026-01-21 | v1.0 | åˆå§‹ç‰ˆæœ¬ï¼Œå®šä¹‰æ¨¡å—ä¾èµ–å…³ç³»å›¾ | - |

---

## âš ï¸ é‡è¦æç¤º

1. **ä¸¥æ ¼éµå¾ªä¾èµ–å±‚æ¬¡**ï¼šç¦æ­¢è¿åä¾èµ–æ–¹å‘çš„ä¾èµ–
2. **é¿å…å¾ªç¯ä¾èµ–**ï¼šå‘ç°å¾ªç¯ä¾èµ–å¿…é¡»ç«‹å³ä¿®å¤
3. **åŠæ—¶æ›´æ–°æ–‡æ¡£**ï¼šä¾èµ–å…³ç³»å˜æ›´å¿…é¡»æ›´æ–°æœ¬æ–‡æ¡£
4. **å®šæœŸå®¡æŸ¥**ï¼šå®šæœŸå®¡æŸ¥ä¾èµ–å…³ç³»ï¼Œä¼˜åŒ–æ¶æ„
