# 向后兼容性测试

本目录包含向后兼容性测试，确保新架构与旧版本兼容。

## 测试内容

- **旧配置格式兼容性**：测试旧配置格式是否仍然有效
- **旧API使用方式兼容性**：测试旧API调用方式是否仍然有效
- **旧适配器接口兼容性**：测试只实现旧接口的适配器是否仍然有效
- **配置迁移路径**：测试从v1.0到v2.0的配置迁移
- **可选功能禁用兼容性**：测试禁用所有新功能时的兼容性
- **适配器注册向后兼容**：测试适配器注册方式向后兼容
- **响应格式兼容性**：测试响应格式与旧版本一致
- **错误处理兼容性**：测试错误处理与旧版本一致

## 运行测试

```bash
# 运行所有兼容性测试
pytest tests/compatibility/ -v -m compatibility

# 运行特定测试
pytest tests/compatibility/test_backward_compatibility.py::TestBackwardCompatibility::test_old_config_format -v
```

## 兼容性保证

### 配置兼容性
- ✅ 旧配置格式（v1.0）仍然有效
- ✅ 配置自动迁移（v1.0 → v2.0）
- ✅ 可选功能可禁用

### API兼容性
- ✅ 旧API调用方式仍然有效
- ✅ 响应格式与旧版本一致
- ✅ 错误处理与旧版本一致

### 适配器兼容性
- ✅ 旧适配器接口仍然有效
- ✅ 适配器注册方式向后兼容

## 迁移指南

如果从v1.0迁移到v2.0：

1. **自动迁移**：使用 `ConfigMigrator` 自动迁移配置
2. **手动迁移**：参考 `docs/guides/configuration.md`
3. **验证**：运行兼容性测试确保迁移成功
