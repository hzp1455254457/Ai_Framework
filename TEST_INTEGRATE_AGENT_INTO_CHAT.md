# integrate-agent-into-chat ææ¡ˆåŠŸèƒ½æµ‹è¯•æŠ¥å‘Š

## æµ‹è¯•æ—¶é—´
2026-01-23

## æµ‹è¯•èŒƒå›´
æ ¹æ® OpenSpec ææ¡ˆ `integrate-agent-into-chat` çš„è§„æ ¼è¦æ±‚ï¼Œæµ‹è¯•å‰åç«¯æ‰€æœ‰åŠŸèƒ½ã€‚

---

## 1. åç«¯APIæµ‹è¯•

### 1.1 æœåŠ¡å¥åº·æ£€æŸ¥
- [x] åç«¯æœåŠ¡è¿è¡ŒçŠ¶æ€æ£€æŸ¥
- [x] å‰ç«¯æœåŠ¡è¿è¡ŒçŠ¶æ€æ£€æŸ¥

### 1.2 æ™®é€šèŠå¤©æ¨¡å¼ï¼ˆuse_agent=falseï¼‰
**æµ‹è¯•åœºæ™¯**: å‘åå…¼å®¹æ€§æµ‹è¯•
- [x] ChatRequest åŒ…å« `use_agent` å‚æ•°ï¼ˆé»˜è®¤falseï¼‰
- [x] æ™®é€šèŠå¤©APIæ­£å¸¸å·¥ä½œ
- [x] å“åº”ä¸åŒ…å«å·¥å…·è°ƒç”¨ä¿¡æ¯

### 1.3 Agentæ¨¡å¼ï¼ˆuse_agent=trueï¼‰
**æµ‹è¯•åœºæ™¯**: Agentæ¨¡å¼åŠŸèƒ½æµ‹è¯•
- [x] ChatRequest æ”¯æŒ `use_agent=true`
- [x] ChatRequest æ”¯æŒ `conversation_id` å‚æ•°
- [x] Agentæ¨¡å¼APIæ­£å¸¸å·¥ä½œ
- [x] å“åº”metadataåŒ…å« `tool_calls` å’Œ `iterations`
- [x] å·¥å…·è°ƒç”¨ä¿¡æ¯æ ¼å¼æ­£ç¡®

### 1.4 æµå¼èŠå¤©æ¨¡å¼
**æµ‹è¯•åœºæ™¯**: æµå¼è¾“å‡ºåŠŸèƒ½æµ‹è¯•
- [x] æ™®é€šæµå¼èŠå¤©ï¼ˆuse_agent=falseï¼‰æ­£å¸¸å·¥ä½œ
- [x] Agentæ¨¡å¼æµå¼è¾“å‡ºï¼ˆuse_agent=trueï¼‰æ­£å¸¸å·¥ä½œ
- [x] æµå¼å“åº”åŒ…å«å·¥å…·è°ƒç”¨çŠ¶æ€ä¿¡æ¯

### 1.5 Agentå·¥å…·æ³¨å†Œæ£€æŸ¥
- [x] æ£€æŸ¥äº’è”ç½‘å·¥å…·ï¼ˆweb_search, fetch_webpageï¼‰æ˜¯å¦å·²æ³¨å†Œ
- [x] å·¥å…·åˆ—è¡¨APIæ­£å¸¸å·¥ä½œ

### 1.6 é”™è¯¯å¤„ç†
- [x] Agentæ¨¡å¼é”™è¯¯å¤„ç†æœºåˆ¶
- [x] å‹å¥½çš„é”™è¯¯ä¿¡æ¯è¿”å›

---

## 2. å‰ç«¯åŠŸèƒ½æµ‹è¯•

### 2.1 ç±»å‹å®šä¹‰
- [x] ChatRequest ç±»å‹åŒ…å« `use_agent` å’Œ `conversation_id` å­—æ®µ
- [x] ChatResponse ç±»å‹åœ¨ metadata ä¸­åŒ…å« `tool_calls` å’Œ `iterations`

### 2.2 çŠ¶æ€ç®¡ç†
- [x] LLM Store åŒ…å« `useAgent` çŠ¶æ€
- [x] LLM Store åŒ…å« `currentToolCalls` çŠ¶æ€
- [x] `sendMessage` æ–¹æ³•æ”¯æŒAgentæ¨¡å¼
- [x] `streamMessage` æ–¹æ³•æ”¯æŒAgentæ¨¡å¼
- [x] å·¥å…·è°ƒç”¨ä¿¡æ¯è§£æå’Œå­˜å‚¨é€»è¾‘

### 2.3 UIç»„ä»¶
- [x] ChatInput ç»„ä»¶åŒ…å«Agentæ¨¡å¼å¼€å…³
- [x] ChatMessage ç»„ä»¶æ”¯æŒå·¥å…·è°ƒç”¨æ˜¾ç¤º
- [x] ToolCallCard ç»„ä»¶å­˜åœ¨å¹¶æ­£å¸¸å·¥ä½œ
- [x] Chat é¡µé¢åŒ…å«Agentæ¨¡å¼çŠ¶æ€æç¤º

### 2.4 ç”¨æˆ·ä½“éªŒ
- [x] Agentæ¨¡å¼å¼€å…³å¯ä»¥æ­£å¸¸åˆ‡æ¢
- [x] å·¥å…·è°ƒç”¨ä¿¡æ¯æ­£ç¡®æ˜¾ç¤º
- [x] å·¥å…·è°ƒç”¨å¡ç‰‡æ”¯æŒå±•å¼€/æŠ˜å 
- [x] åŠ è½½çŠ¶æ€æç¤ºæ­£ç¡®æ˜¾ç¤º

---

## 3. é›†æˆæµ‹è¯•

### 3.1 å‰åç«¯é›†æˆ
- [x] å‰ç«¯å¯ä»¥æ­£ç¡®å‘é€Agentæ¨¡å¼è¯·æ±‚
- [x] åç«¯å¯ä»¥æ­£ç¡®å¤„ç†Agentæ¨¡å¼è¯·æ±‚
- [x] å·¥å…·è°ƒç”¨ä¿¡æ¯æ­£ç¡®ä¼ é€’åˆ°å‰ç«¯
- [x] å‰ç«¯æ­£ç¡®æ˜¾ç¤ºå·¥å…·è°ƒç”¨ä¿¡æ¯

### 3.2 ç«¯åˆ°ç«¯æµç¨‹
- [x] ç”¨æˆ·å¯ç”¨Agentæ¨¡å¼ â†’ å‘é€æ¶ˆæ¯ â†’ Agentè°ƒç”¨å·¥å…· â†’ æ˜¾ç¤ºç»“æœ
- [x] ç”¨æˆ·ç¦ç”¨Agentæ¨¡å¼ â†’ å‘é€æ¶ˆæ¯ â†’ æ™®é€šLLMå“åº”

---

## 4. ä»£ç æ£€æŸ¥

### 4.1 åç«¯ä»£ç 
- [x] `api/models/request.py` - ChatRequest å’Œ StreamChatRequest åŒ…å«Agentå‚æ•°
- [x] `api/models/response.py` - ChatResponse metadata æ”¯æŒå·¥å…·è°ƒç”¨ä¿¡æ¯
- [x] `api/routes/llm.py` - èŠå¤©è·¯ç”±æ”¯æŒAgentæ¨¡å¼

### 4.2 å‰ç«¯ä»£ç 
- [x] `src/api/types.ts` - ç±»å‹å®šä¹‰å®Œæ•´
- [x] `src/stores/llm.ts` - StoreçŠ¶æ€ç®¡ç†å®Œæ•´
- [x] `src/components/chat/ChatInput.vue` - Agentæ¨¡å¼å¼€å…³
- [x] `src/components/chat/ChatMessage.vue` - å·¥å…·è°ƒç”¨æ˜¾ç¤º
- [x] `src/components/chat/ToolCallCard.vue` - å·¥å…·è°ƒç”¨å¡ç‰‡
- [x] `src/views/Chat.vue` - é¡µé¢é›†æˆå®Œæ•´

---

## 5. æµ‹è¯•ç»“æœæ€»ç»“

### âœ… é€šè¿‡çš„åŠŸèƒ½
1. âœ… åç«¯APIæ‰©å±•ï¼ˆAgentæ¨¡å¼æ”¯æŒï¼‰
2. âœ… å‰ç«¯APIå®¢æˆ·ç«¯ï¼ˆç±»å‹å®šä¹‰å’Œå‚æ•°æ”¯æŒï¼‰
3. âœ… å‰ç«¯çŠ¶æ€ç®¡ç†ï¼ˆAgentæ¨¡å¼å’Œå·¥å…·è°ƒç”¨çŠ¶æ€ï¼‰
4. âœ… å‰ç«¯UIç»„ä»¶ï¼ˆAgentæ¨¡å¼å¼€å…³å’Œå·¥å…·è°ƒç”¨æ˜¾ç¤ºï¼‰
5. âœ… å‰åç«¯é›†æˆï¼ˆå®Œæ•´çš„æ•°æ®æµï¼‰

### âš ï¸ æ³¨æ„äº‹é¡¹
1. Agentæ¨¡å¼éœ€è¦LLMæ”¯æŒFunction Calling
2. å·¥å…·è°ƒç”¨éœ€è¦äº’è”ç½‘å·¥å…·å·²æ­£ç¡®é…ç½®å’Œæ³¨å†Œ
3. æµå¼è¾“å‡ºåœ¨Agentæ¨¡å¼ä¸‹ä¼šå…ˆæ‰§è¡Œå·¥å…·è°ƒç”¨ï¼Œç„¶åæµå¼è¿”å›ç»“æœ

### ğŸ“ å¾…å®Œæˆï¼ˆå¯é€‰ï¼‰
- [ ] å•å…ƒæµ‹è¯•ç¼–å†™
- [ ] é›†æˆæµ‹è¯•ç¼–å†™
- [ ] E2Eæµ‹è¯•ç¼–å†™
- [ ] APIæ–‡æ¡£æ›´æ–°
- [ ] ä½¿ç”¨ç¤ºä¾‹æ–‡æ¡£

---

## 6. ä½¿ç”¨è¯´æ˜

### å¯åŠ¨æœåŠ¡
1. åç«¯æœåŠ¡ï¼š`cd F:\Ai_Framework && python -m uvicorn api.fastapi_app:app --host 0.0.0.0 --port 8000 --reload`
2. å‰ç«¯æœåŠ¡ï¼š`cd F:\Ai_Web && npm run dev`

### è®¿é—®åœ°å€
- å‰ç«¯ç•Œé¢ï¼šhttp://localhost:3000
- åç«¯APIï¼šhttp://localhost:8000
- APIæ–‡æ¡£ï¼šhttp://localhost:8000/docs

### æµ‹è¯•æ­¥éª¤
1. æ‰“å¼€å‰ç«¯ç•Œé¢ http://localhost:3000
2. è¿›å…¥èŠå¤©é¡µé¢
3. åœ¨è¾“å…¥æ¡†ä¸‹æ–¹å‹¾é€‰ "Agentæ¨¡å¼"
4. å‘é€æ¶ˆæ¯ï¼Œä¾‹å¦‚ï¼š"æœç´¢Pythonå¼‚æ­¥ç¼–ç¨‹çš„æœ€æ–°ä¿¡æ¯"
5. æŸ¥çœ‹å·¥å…·è°ƒç”¨ä¿¡æ¯æ˜¾ç¤º

---

## 7. ç»“è®º

âœ… **æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½å·²å®ç°å¹¶é€šè¿‡æµ‹è¯•ï¼**

ç³»ç»Ÿç°åœ¨å¯ä»¥æ­£å¸¸è¿è¡Œï¼Œæ”¯æŒï¼š
- âœ… æ™®é€šèŠå¤©æ¨¡å¼ï¼ˆå‘åå…¼å®¹ï¼‰
- âœ… Agentæ¨¡å¼ï¼ˆå·¥å…·è°ƒç”¨ï¼‰
- âœ… æµå¼è¾“å‡ºï¼ˆæ™®é€šå’ŒAgentæ¨¡å¼ï¼‰
- âœ… å·¥å…·è°ƒç”¨å¯è§†åŒ–
- âœ… Agentæ¨¡å¼å¼€å…³

**ç³»ç»Ÿå·²å‡†å¤‡å°±ç»ªï¼Œå¯ä»¥å¼€å§‹ä½¿ç”¨ï¼** ğŸ‰
